# Ziffi Chess

Ziffi Chess 是一个基于Web的国际象棋游戏，实现了Ziffi独特的6步快棋模式。游戏支持多种模式，包括人机对战、机器自战、本地双人对战和在线对战。

## 特性

- ✅ **Ziffi 6步快棋模式**: 每位玩家仅有6次移动机会
- ✅ **多种游戏模式**: 人机对战、机器自战、本地双人、在线对战
- ✅ **6级难度系统**: 对应ELO积分600-2800
- ✅ **完整悔棋系统**: 支持连续撤销和重做
- ✅ **棋盘操作**: 支持翻转棋盘和交换角色
- ✅ **PWA支持**: 可安装、离线使用
- ✅ **响应式设计**: 完美适配手机和平板
- ✅ **云存储**: 支持游戏进度云端保存
- ✅ **优化性能**: 使用节流/防抖优化、错误处理等

## 安装和运行

### 方法1: 本地服务器（推荐）

1. 安装Node.js
2. 安装http-server:
   ```bash
   npm install -g http-server
   ```
3. 在项目根目录运行:
   ```bash
   http-server
   ```
4. 打开浏览器访问提供的地址

### 方法2: Python服务器

1. 在项目根目录运行:
   ```bash
   python -m http.server 8000
   ```
2. 打开浏览器访问 http://localhost:8000

### 方法3: 使用IDE内置服务器

大多数现代IDE（如VSCode的Live Server扩展）都可以直接运行项目。

## 使用说明

1. 打开游戏页面
2. 选择游戏模式（人机对战、机器自战、本地双人或挑战好友）
3. 如选择人机对战，可设置AI难度级别
4. 开始游戏，享受6步快棋的乐趣！

## 控制方式

- **鼠标/触摸**: 点击棋子选择，再点击目标位置移动
- **键盘快捷键**:
  - `Ctrl+Z` / `Cmd+Z`: 撤销
  - `Ctrl+Shift+Z` / `Cmd+Shift+Z`: 重做
  - `R`: 新游戏
  - `F`: 翻转棋盘
  - `S`: 交换角色
  - `D`: 显示调试信息

## 技术栈

- **HTML5**: 结构标记
- **CSS3**: 样式和动画
- **JavaScript ES6+**: 游戏逻辑和交互
- **PWA**: 离线支持和安装功能
- **Service Worker**: 缓存和离线能力
- **LocalStorage**: 本地数据存储

## 文件结构

```
chess-six0-qoder/
├── index.html              # 主页面
├── css/
│   └── style.css          # 样式文件
├── js/
│   ├── chess-engine.js    # 国际象棋核心引擎
│   ├── game-controller.js # 游戏控制器
│   └── main.js           # 主程序入口
├── sw.js                  # Service Worker
├── sw-register.js         # Service Worker注册
├── manifest.json          # PWA配置文件
├── favicon.ico            # 网站图标
├── icons/                 # 图标文件夹
├── PROJECT_SUMMARY.md     # 项目总结
└── README.md              # 本文件
```

## 浏览器兼容性

- Chrome 60+
- Firefox 60+
- Safari 12+
- Edge 79+

## 功能清单

### 已实现功能

- [x] 人机对战模式
- [x] 机器自战模式
- [x] 本地双人对战模式
- [x] 在线对战模式（模拟）
- [x] 6级难度系统（ELO 600-2800）
- [x] 玩家和机器均可设定难度
- [x] 连续悔棋和重做
- [x] 局面不变时模式切换
- [x] 棋盘翻转功能
- [x] 角色交换功能
- [x] PWA离线支持
- [x] 手机屏幕适配
- [x] Ziffi 6步格式规则
- [x] 2分钟限时
- [x] 中期开局
- [x] 性能优化（节流/防抖）
- [x] 错误处理和恢复
- [x] 触摸事件优化

## 优化改进

### 已完成优化

1. **AI算法优化**:
   - 修复了AI移动逻辑的潜在bug
   - 改进了不同难度级别的策略实现
   - 优化了minimax算法的性能

2. **悔棋系统优化**:
   - 修复了状态恢复的潜在问题
   - 添加了栈大小限制以节省内存
   - 改进了撤销/重做操作的稳定性

3. **性能优化**:
   - 添加了节流/防抖功能以优化事件处理
   - 改进了DOM操作性能
   - 优化了窗口大小变化处理

4. **错误处理**:
   - 添加了全局错误处理机制
   - 改进了初始化错误处理
   - 添加了Promise拒绝处理

5. **用户体验优化**:
   - 改进了触摸事件处理
   - 防止了多点触控缩放
   - 优化了键盘快捷键处理

## 未来改进

- 集成真实的在线对战服务器
- 使用WebAssembly提升AI计算性能
- 添加音效和背景音乐
- 实现更复杂的AI算法
- 添加游戏回放功能
- 集成真实的Cloudflare Workers KV存储

## 许可证

MIT License